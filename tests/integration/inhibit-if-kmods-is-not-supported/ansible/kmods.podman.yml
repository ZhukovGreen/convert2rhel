- hosts: all
  tasks:
    - name: Install CentOS/OL 8 packages for development
      yum:
        use_backend: dnf
        name: ["vim", "python3-devel", "git", "python3-virtualenv", "rpmlint", "rpm-build", "python3-six", "python3-nose"]
        state: present
      register: yum_res

    - name: Copy repofile with internal RHEL 8 repositories
      copy:
        src: 'rhel-8-internal.repo'
        dest: /etc/yum.repos.d

    - name: Download convert2rhel COPR repository for conversions to RHEL 8
      get_url:
        url: https://copr.fedorainfracloud.org/coprs/g/oamg/convert2rhel/repo/epel-8/group_oamg-convert2rhel-epel-8.repo
        dest: /etc/yum.repos.d/c2r_copr.repo

    - name: Report
      find:
        paths: /etc/yum.repos.d
      register: files

    - debug:
        msg: " {{ [item.path] }} "


    - name: Install the convert2rhel package
      yum:
        name: "https://github.com/oamg/convert2rhel/releases/download/v0.17/convert2rhel-0.17-1.el8.noarch.rpm"
      register: yum_res

    - name: Show output of the previous yum call
      debug:
        msg: "{{ yum_res.results[0].split('\n') }}"

